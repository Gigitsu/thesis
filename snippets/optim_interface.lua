w_new, fs = optim.method(func, w, state)
